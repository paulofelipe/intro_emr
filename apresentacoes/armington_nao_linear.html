<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Modelo de Armington N√£o-Linear</title>
    <meta charset="utf-8" />
    <meta name="author" content="Paulo Felipe Alencar | üë®‚Äçüíª | 04/2019" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, title-slide

# Modelo de Armington N√£o-Linear
### Paulo Felipe Alencar | üë®‚Äçüíª | 04/2019

---






class: center, middle, inverse
# Sobre o Modelo

---

## Introdu√ß√£o

- Modelo de Equil√≠brio Parcial

- O interesse √© em um produto espec√≠fico (Ex.: "Fornos")

- Hip√≥tese de Armington (1969): Os produtos (**variedades**) (importados e dom√©sticos) s√£o substitutos imperfeitos

- Variedade √© uma combina√ß√£o produto-origem: tv-chinesa, tv-brasileira, tv-americana etc.

- Pode ser utilizado para analisar impactos de tarifas, barreiras n√£o-tarif√°rias, choques de oferta e choques de demanda

---
class: center, middle, inverse
# Especifica√ß√£o do Modelo

---
## Prefer√™ncias

- O consumidor tem prefer√™ncias do tipo CES (elasticidade de substitui√ß√£o constante)

- O consumo de cada variedade √© agregada em um bem composto `\(Q\)`

$$Q = \left[ \sum_{i=1}^N \alpha_i^\frac{1-\sigma}{\sigma}q_i^\frac{\sigma-1}{\sigma}\right]^\frac{\sigma}{\sigma-1} $$
- O √≠ndice `\(i\)` representa uma variedade (origem)

- O consumidor maximiza `\(Q\)` sujeito √† restri√ß√£o `\(\sum_{i=1}^N p_i q_i = E\)`, em que `\(p_i\)` √© o pre√ßo ao consumidor (inclui tarifas) da variedade `\(i\)` e `\(E\)` √© o disp√™ndio total

- O bem composto `\(Q\)` tem um √≠ndice de pre√ßo `\(P\)`:

`$$P = \left[ \sum_{i=1}^N (\alpha_i p_i)^{1-\sigma}\right]^\frac{1}{1-\sigma}$$`

`$$PQ = E$$`
---
## Demanda por variedade

- A demanda por cada variedade `\(i\)` √© dada por:

`$$q_i = \alpha_i^{1-\sigma} \left(\frac{p_i}{P}\right)^{-\sigma}\frac{E}{P}$$`

---
## Oferta

- √â assumida uma curva do tipo elasticidade constante:

- O produtor recebe `\(p_i/(1 + t_i)\)`, em que `\(t_i\)` √© a tarifa cobrada no consumo da variedade `\(i\)`

`$$x_i = k_i^s \left(\frac{p_i}{1+t_i}\right)^{\varepsilon_i}$$`

- `\(k_i^s\)`, que √© um **par√¢metro**, engloba outros fatores que podem afetar a oferta

---
## Demanda Total

- O consumidor tem uma disp√™ndio `\(E\)` para ser alocado entre as variedades

- Este valor pode ser fixo ou n√£o

- Usualmente, assume-se uma curva de demanda total

$$Q = k^d P^\eta $$

- Multiplicando os dois lados por `\(P\)`, chega-se a equa√ß√£o de disp√™ndio total:

`$$E=k^dP^{\eta+1}$$`

---
## Sistema

- Disp√™ndio Total
`$$\color{red}{E}=k^d\color{red}{P}^{\eta+1}$$`

- √çndice de pre√ßo do bem composto `\(Q\)` ( `\(Q = E/P\)` )

`$$\color{red}{P} = \left[ \sum_{i=1}^N (\alpha_i \color{blue}{p_i})^{1-\sigma}\right]^\frac{1}{1-\sigma}$$`

- Demanda por variedade
`$$\color{red}{q_i} = \alpha_i^{1-\sigma} \left(\frac{\color{blue}{p_i}}{\color{red}{P}}\right)^{-\sigma}\frac{\color{red}{E}}{\color{red}{P}}$$`

- Oferta por variedade
`$$\color{red}{x_i} = k_i^s \left(\frac{\color{blue}{p_i}}{1+t_i}\right)^{\varepsilon_i}$$`

- Equil√≠brio - oferta x demanda por variedade
`$$\color{red}{q_i} = \color{red}{x_i}$$`

---
## Sistema em Varia√ß√µes

- Disp√™ndio Total
`$$\color{red}{\hat{E}}=\hat{k}^d\color{red}{\hat{P}}^{\eta+1}$$`

- √çndice de pre√ßo do bem composto `\(Q\)` ( `\(Q = E/P\)` )

`$$\color{red}{\hat{P}} = \left[ \sum_{i=1}^N \pi_i(\hat{\alpha_i} \color{blue}{\hat{p_i}})^{1-\sigma}\right]^\frac{1}{1-\sigma}, ~ \pi_i = \frac{p_iq_i}{\sum_i p_iq_i}$$`

- Demanda por variedade
`$$\color{red}{\hat{q_i}} = \hat{\alpha_i}^{1-\sigma} \left(\frac{\color{blue}{\hat{p_i}}}{\color{red}{\hat{P}}}\right)^{-\sigma}\frac{\color{red}{\hat{E}}}{\color{red}{\hat{P}}}$$`

- Oferta por variedade
`$$\color{red}{\hat{x_i}} = k_i^s \left(\frac{\color{blue}{\hat{p_i}}}{\hat{\tau_i}}\right)^{\varepsilon_i}, ~~ \tau_i = 1+t_i$$`

- Equil√≠brio - oferta x demanda por variedade
`$$\color{red}{\hat{q_i}} = \color{red}{\hat{x_i}}$$`

---
class: center, middle, inverse
# Implementando o modelo no R


---
## Dados

- Iremos considerar 3 regi√µes (variedades): `bra`, `usa` e `row`

```r
reg &lt;- c("bra", "usa", "row")
```


- Dados base:
- Valores a pre√ßos internos:


```r
v0 &lt;- c(bra = 60, usa = 30, row = 10) 
```

- Tarifas Iniciais:

```r
t0 &lt;- c(bra = 0, usa = 0, row = 0)
```

- Elasticidades:


```r
eta &lt;- -2 # Elasticidade-pre√ßo da demanda
epsilon &lt;- c(bra = 1,usa = 10,row = 10) # Elasticidades-pre√ßo das ofertas
sigma &lt;- 4 # Elasticidade de substitui√ß√£o
```


---
## Componentes do modelo

- Carregando os pacotes que utilizaremos:

```r
library(emr)
library(tidyverse)
```

- Criando os componentes

```r
params &lt;- list()
variables &lt;- list()
equations &lt;- list()
sets &lt;- list()
update_equations &lt;- list()
```

- `sets` deve uma lista nomeada de √≠ndices

- Neste modelo, teremos apenas um conjunto de √≠ndices que chamaremos de `REG`


```r
sets[["REG"]] &lt;- reg
sets
```

```
## $REG
## [1] "bra" "usa" "row"
```

---
## Disp√™ndio - Par√¢metros

`$$\color{red}{\hat{E}}=\hat{k}^d\color{red}{\hat{P}}^{\eta+1}$$`


```r
params[["k_d"]] &lt;- create_param(
  value = 1,
  indexes = list(k_d = "k_d"),
  desc = "varia√ß√£o no shift da demanda total"
)

params[["eta"]] &lt;- create_param(
  value = eta,
  indexes = list(eta = "eta"),
  desc = "elasticidade-pre√ßo da demanda"
)
```


---
## Disp√™ndio - Vari√°veis

`$$\color{red}{\hat{E}}=\hat{k}^d\color{red}{\hat{P}}^{\eta+1}$$`


```r
variables[["E"]] &lt;- create_variable(
  value = 1,
  indexes = list(E = "E"),
  type = "defined",
  desc = "varia√ß√£o no disp√™ndio total"
)

variables[["P"]] &lt;- create_variable(
  value = 1,
  indexes = list(P = "P"),
  type = "defined",
  desc = "varia√ß√£o no √≠ndice de pre√ßo do bem composto"
)
```


---
## Disp√™ndio - Equa√ß√µes

`$$\color{red}{\hat{E}}=\hat{k}^d\color{red}{\hat{P}}^{\eta+1}$$`


```r
equations[["E_E"]] &lt;- create_equation(
  "E = k_d * P^(eta+1)",
  type = "defining",
  desc = "varia√ß√£o no disp√™ndio total"
)
```

---
## √çndice de Pre√ßo - Par√¢metros

`$$\color{red}{\hat{P}} = \left[ \sum_{i=1}^N \pi_i(\hat{\alpha_i} \color{blue}{\hat{p_i}})^{1-\sigma}\right]^\frac{1}{1-\sigma}, ~ \pi_i = \frac{p_iq_i}{\sum_i p_iq_i}$$`


```r
params[["alpha"]] &lt;- create_param(
  value = 1,
  indexes = sets["REG"],
  desc = "varia√ß√£o no par√¢metro de prefer√™ncia"
)

params[["pi"]] &lt;- create_param(
  value = v0/sum(v0),
  indexes = sets["REG"],
  desc = "participacao no disp√™ndio total"
)

params[["sigma"]] &lt;- create_param(
  value = sigma,
  indexes = list(sigma = "sigma"),
  desc = "elasticidade de substitui√ß√£o" 
)
```

---
## √çndice de Pre√ßo - Vari√°veis

`$$\color{red}{\hat{P}} = \left[ \sum_{i=1}^N \pi_i(\hat{\alpha_i} \color{blue}{\hat{p_i}})^{1-\sigma}\right]^\frac{1}{1-\sigma}, ~ \pi_i = \frac{p_iq_i}{\sum_i p_iq_i}$$`


```r
variables[["p"]] &lt;- create_variable(
  value = 1,
  indexes = sets['REG'],
  type = 'undefined',
  desc = 'varia√ß√£o nos pre√ßos internos'
)
```

---
## √çndice de Pre√ßo - Equa√ß√µes

`$$\color{red}{\hat{P}} = \left[ \sum_{i=1}^N \pi_i(\hat{\alpha_i} \color{blue}{\hat{p_i}})^{1-\sigma}\right]^\frac{1}{1-\sigma}, ~ \pi_i = \frac{p_iq_i}{\sum_i p_iq_i}$$`


```r
equations[["E_P"]] &lt;- create_equation(
  'P = sum(pi * (alpha * p)^(1-sigma))^(1/(1-sigma))',
  type = "defining",
  desc = "varia√ß√£o no √≠ndice de pre√ßo do bem composto"
)
```

---
## Demanda por variedade (regi√£o) - Vari√°veis

`$$\color{red}{\hat{q_i}} = \hat{\alpha_i}^{1-\sigma} \left(\frac{\color{blue}{\hat{p_i}}}{\color{red}{\hat{P}}}\right)^{-\sigma}\frac{\color{red}{\hat{E}}}{\color{red}{\hat{P}}}$$`


```r
variables[["q"]] &lt;- create_variable(
  value = 1,
  indexes = sets['REG'],
  type = "defined",
  desc = "varia√ß√£o na demanda por variedade"
)
```

---
## Demanda por variedade (regi√£o) - Equa√ß√£o

`$$\color{red}{\hat{q_i}} = \hat{\alpha_i}^{1-\sigma} \left(\frac{\color{blue}{\hat{p_i}}}{\color{red}{\hat{P}}}\right)^{-\sigma}\frac{\color{red}{\hat{E}}}{\color{red}{\hat{P}}}$$`


```r
equations[["E_q"]] &lt;- create_equation(
  'q[i] = alpha[i]^(1-sigma)*(p[i]/P)^(-sigma)*E/P',
  indexes = "i in REG",
  type = "defining",
  desc = "varia√ß√£o na quantidade demandada"
)
```

- Utilizamos o √≠ndice `\(i \in REG\)` para calcular a quantidade para cada regi√£o 

- Note que poder√≠amos utilizar o c√°lculo vetorizado do R para evitar o *loop* que ser√° utilizado para calcular a quantidade para cada `\(i\)`

---
## Demanda por variedade (regi√£o) - Vari√°veis

`$$\color{red}{\hat{q_i}} = \hat{\alpha_i}^{1-\sigma} \left(\frac{\color{blue}{\hat{p_i}}}{\color{red}{\hat{P}}}\right)^{-\sigma}\frac{\color{red}{\hat{E}}}{\color{red}{\hat{P}}}$$`


```r
variables[["q"]] &lt;- create_variable(
  value = 1,
  indexes = sets['REG'],
  type = "defined",
  desc = "varia√ß√£o na demanda por variedade"
)
```

---
## Oferta por variedade (regi√£o) - Par√¢metros

`$$\color{red}{\hat{x_i}} = k_i^s \left(\frac{\color{blue}{\hat{p_i}}}{\hat{\tau_i}}\right)^{\varepsilon_i}$$`


```r
params[["k_s"]] &lt;- create_param(
  value = 1,
  indexes = sets['REG'],
  desc = "varia√ß√£o no shift da curva de oferta"
)

params[["epsilon"]] &lt;- create_param(
  value = epsilon,
  indexes = sets['REG'],
  desc = 'elasticidade-pre√ßo da oferta'
)

params[["tau"]] &lt;- create_param(
  value = 1,
  indexes = sets['REG'],
  desc = "varia√ß√£o no poder da tarifa"
)
```

---
## Oferta por variedade (regi√£o) - Vari√°veis

`$$\color{red}{\hat{x_i}} = k_i^s \left(\frac{\color{blue}{\hat{p_i}}}{\hat{\tau_i}}\right)^{\varepsilon_i}$$`


```r
variables[["x"]] &lt;- create_variable(
  value = 1,
  indexes = sets['REG'],
  type = "defined",
  desc = "varia√ß√£o na oferta da variedade i"
)
```

---
## Oferta por variedade (regi√£o) - Equa√ß√£o

`$$\color{red}{\hat{x_i}} = k_i^s \left(\frac{\color{blue}{\hat{p_i}}}{\hat{\tau_i}}\right)^{\varepsilon_i}$$`


```r
equations[["e_x"]] &lt;- create_equation(
  "x[i] = k_s[i] * (p[i]/(tau[i]))^epsilon[i]",
  indexes = "i in REG",
  type = "defining",
  desc = "varia√ß√£o na oferta da variedade i"
)
```


---
## Condi√ß√£o de Equil√≠brio 

`$$\color{red}{\hat{q_i}} = \color{red}{\hat{x_i}}$$`


```r
equations[["E_p"]] &lt;- create_equation(
  "x[i] - q[i]",
  indexes = "i in REG",
  type = "mcc",
  desc = "condi√ß√£o de equil√≠brio pro pre√ßo"
)
```

---
## Equa√ß√µes de Atualiza√ß√µes

- √â poss√≠vel definir f√≥rmulas que calculam o valor de alguma vari√°vel de interesse no novo equil√≠brio

- Por exemplo: Disp√™ndio por origem:

`$$v_i' = v_i \times \hat{p_i} \times \hat{q_i}$$`


```r
params[["v0"]] &lt;- create_param(
  value = v0,
  indexes = sets["REG"],
  desc = "valor do disp√™ndio inicial"
)


update_equations[["v0"]] &lt;- create_equation(
  'v0[i] = v0[i] * p[i] * q[i]',
  indexes = "i in REG",
  desc = "valor do disp√™ndio por origem"
)
```



---
## Definindo o Modelo


```r
armington &lt;- list(
    sets = sets,
    params = params,
    variables = variables,
    equations = equations,
    update_equations = update_equations
  )

# Checando
sol &lt;- solve_emr(armington)
sol$sol$message
```

```
## [1] "Successful convergence"
```

---
class: center, middle, inverse
# Experimento

---
## Descri√ß√£o do Experimento e Solu√ß√£o

- Iremos simular a implementa√ß√£o de uma tarifa de 10% para a importa√ß√£o de bens origin√°rios dos Estados Unidos


```r
armington$params$tau$value[["usa"]] &lt;- 1.1
```

- Resolvendo o modelo:


```r
sol_cfl &lt;- solve_emr(armington)
sol_cfl$sol$message
```

```
## [1] "Successful convergence"
```


---
## Resultados

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Resultados da simula√ß√£o - Vari√°veis Agregadas - Varia√ß√£o %&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Disp√™ndio (E) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Pre√ßo (P) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Quantidade (Q) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; -2,7 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; 2,77 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; -5,33 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p style="margin-bottom:3cm;"&gt; &lt;/p&gt;
  

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Resultados da simula√ß√£o - Varia√ß√£o %&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Regi√£o &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Pre√ßo (p) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Quantidade (q) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; bra &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; 1,10 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; 1,10 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; usa &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; 7,46 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; -20,80 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; row &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; 0,39 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; "&gt; 3,99 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
